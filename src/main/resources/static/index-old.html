<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git‰ª£Á†ÅReviewÊúçÂä°</title>
    <link href="https://unpkg.com/element-ui/lib/theme-chalk/index.css" rel="stylesheet">
    <script src="https://unpkg.com/vue@2.6.14/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
        }
        .review-result {
            background: #ffffff;
            padding: 20px;
            border-radius: 4px;
            margin-top: 20px;
            border: 1px solid #e6e6e6;
        }
        /* Markdown Ê∏≤ÊüìÊ†∑Âºè */
        .review-result h1 {
            font-size: 28px;
            border-bottom: 2px solid #409eff;
            padding-bottom: 10px;
            margin-top: 20px;
            margin-bottom: 15px;
        }
        .review-result h2 {
            font-size: 24px;
            border-bottom: 1px solid #dcdfe6;
            padding-bottom: 8px;
            margin-top: 18px;
            margin-bottom: 12px;
        }
        .review-result h3 {
            font-size: 20px;
            margin-top: 16px;
            margin-bottom: 10px;
            color: #303133;
        }
        .review-result h4 {
            font-size: 18px;
            margin-top: 14px;
            margin-bottom: 8px;
            color: #606266;
        }
        .review-result p {
            margin: 10px 0;
            line-height: 1.6;
            color: #606266;
        }
        .review-result ul, .review-result ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        .review-result li {
            margin: 5px 0;
            line-height: 1.5;
        }
        .review-result code {
            background: #f5f7fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', Consolas, Monaco, monospace;
            font-size: 13px;
            color: #e83e8c;
        }
        .review-result pre {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 15px 0;
        }
        .review-result pre code {
            background: none;
            color: #abb2bf;
            padding: 0;
        }
        .review-result blockquote {
            border-left: 4px solid #409eff;
            padding-left: 15px;
            margin: 15px 0;
            color: #909399;
            background: #f5f7fa;
            padding: 10px 15px;
            border-radius: 0 4px 4px 0;
        }
        .review-result table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
        }
        .review-result table th {
            background: #f5f7fa;
            padding: 10px;
            border: 1px solid #dcdfe6;
            font-weight: bold;
        }
        .review-result table td {
            padding: 10px;
            border: 1px solid #dcdfe6;
        }
        .review-result a {
            color: #409eff;
            text-decoration: none;
        }
        .review-result a:hover {
            text-decoration: underline;
        }
        .review-result hr {
            border: none;
            border-top: 1px solid #dcdfe6;
            margin: 20px 0;
        }
        .review-result strong {
            font-weight: 600;
            color: #303133;
        }
        .review-result em {
            font-style: italic;
            color: #606266;
        }
        .test-progress {
            margin-top: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #e6e6e6;
        }
        .test-result {
            margin-top: 30px;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            border: 1px solid #e6e6e6;
        }
        .code-container {
            border: 1px solid #e6e6e6;
            border-radius: 4px;
            overflow: hidden;
        }
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: #f8f8f8;
            border-bottom: 1px solid #e6e6e6;
            font-weight: bold;
        }
        .code-content {
            background: #ffffff;
            padding: 15px;
            margin: 0;
            max-height: 600px;
            overflow-y: auto;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            font-size: 14px;
            line-height: 1.6;
        }
        .test-output {
            margin-top: 15px;
            padding: 15px;
            background: #f8f8f8;
            border-radius: 4px;
            border: 1px solid #e6e6e6;
        }
        .test-output pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.3;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <div class="header">
                <h1>Git‰ª£Á†ÅReviewÊúçÂä°</h1>
                <p>‰ΩøÁî®Claude AIËøõË°åËá™Âä®Âåñ‰ª£Á†ÅÂÆ°Êü•</p>
            </div>

            <el-tabs type="border-card" v-model="activeTab">
                <el-tab-pane label="‰ªìÂ∫ìÁÆ°ÁêÜ" name="repos">
                    <div class="section">
                        <h3>Git‰ªìÂ∫ìÈÖçÁΩÆ</h3>
                        <el-button type="primary" @click="showAddDialog = true">Ê∑ªÂä†‰ªìÂ∫ì</el-button>
                        
                        <el-table :data="repositories" style="width: 100%; margin-top: 20px;">
                            <el-table-column prop="name" label="‰ªìÂ∫ìÂêçÁß∞"></el-table-column>
                            <el-table-column prop="repositoryUrl" label="‰ªìÂ∫ìÂú∞ÂùÄ"></el-table-column>
                            <el-table-column prop="description" label="ÊèèËø∞"></el-table-column>
                            <el-table-column label="Êìç‰Ωú" width="200">
                                <template slot-scope="scope">
                                    <el-button size="mini" @click="testConnection(scope.row)">ÊµãËØïËøûÊé•</el-button>
                                    <el-button size="mini" type="danger" @click="deleteRepository(scope.row.id)">Âà†Èô§</el-button>
                                </template>
                            </el-table-column>
                        </el-table>
                    </div>
                </el-tab-pane>

                <el-tab-pane label="‰ª£Á†ÅReview">
                    <div class="section">
                        <h3>‰ª£Á†ÅÂÆ°Êü•</h3>
                        
                        <el-form :model="reviewForm" label-width="120px">
                            <el-form-item label="ÈÄâÊã©‰ªìÂ∫ì">
                                <el-select v-model="reviewForm.repositoryId" placeholder="ËØ∑ÈÄâÊã©‰ªìÂ∫ì" @change="loadBranches">
                                    <el-option v-for="repo in repositories" 
                                               :key="repo.id" 
                                               :label="repo.name" 
                                               :value="repo.id">
                                    </el-option>
                                </el-select>
                                <el-button style="margin-left: 10px" @click="loadRemoteBranches" :loading="remoteLoading">
                                    ‰ªéËøúÁ®ãÊãâÂèñÂàÜÊîØ
                                </el-button>
                            </el-form-item>

                            <el-form-item label="Âü∫Á°ÄÂàÜÊîØ">
                                <el-select v-model="reviewForm.baseBranch" placeholder="ËØ∑ÈÄâÊã©Âü∫Á°ÄÂàÜÊîØ" filterable allow-create>
                                    <el-option v-for="branch in branches" 
                                               :key="'base-' + branch" 
                                               :label="branch" 
                                               :value="branch">
                                    </el-option>
                                </el-select>
                            </el-form-item>
                            
                            <el-form-item label="ÁõÆÊ†áÂàÜÊîØ">
                                <el-select v-model="reviewForm.targetBranch" placeholder="ËØ∑ÈÄâÊã©ÁõÆÊ†áÂàÜÊîØ" filterable allow-create>
                                    <el-option v-for="branch in branches"
                                               :key="'target-' + branch"
                                               :label="branch"
                                               :value="branch">
                                    </el-option>
                                </el-select>
                            </el-form-item>

                            <el-form-item label="ÂÆ°Êü•Ê®°Âºè">
                                <el-select v-model="reviewForm.mode" placeholder="ËØ∑ÈÄâÊã©ÂÆ°Êü•Ê®°Âºè">
                                    <el-option label="‚ö° Âø´ÈÄüÂÆ°Êü• (2-5ÂàÜÈíü)" value="quick">
                                        <span style="float: left">‚ö° Âø´ÈÄüÂÆ°Êü•</span>
                                        <span style="float: right; color: #8492a6; font-size: 13px">2-5ÂàÜÈíü</span>
                                    </el-option>
                                    <el-option label="üìã Ê†áÂáÜÂÆ°Êü• (5-10ÂàÜÈíü)" value="standard">
                                        <span style="float: left">üìã Ê†áÂáÜÂÆ°Êü•</span>
                                        <span style="float: right; color: #8492a6; font-size: 13px">5-10ÂàÜÈíü</span>
                                    </el-option>
                                    <el-option label="üîç Ê∑±Â∫¶ÂÆ°Êü• (10-20ÂàÜÈíü)" value="deep">
                                        <span style="float: left">üîç Ê∑±Â∫¶ÂÆ°Êü•</span>
                                        <span style="float: right; color: #8492a6; font-size: 13px">10-20ÂàÜÈíü</span>
                                    </el-option>
                                    <el-option label="üîí ÂÆâÂÖ®ÂÆ°Êü• (5-10ÂàÜÈíü)" value="security">
                                        <span style="float: left">üîí ÂÆâÂÖ®ÂÆ°Êü•</span>
                                        <span style="float: right; color: #8492a6; font-size: 13px">5-10ÂàÜÈíü</span>
                                    </el-option>
                                    <el-option label="‚ö° ÊÄßËÉΩÂÆ°Êü• (5-10ÂàÜÈíü)" value="performance">
                                        <span style="float: left">‚ö° ÊÄßËÉΩÂÆ°Êü•</span>
                                        <span style="float: right; color: #8492a6; font-size: 13px">5-10ÂàÜÈíü</span>
                                    </el-option>
                                    <el-option label="üèóÔ∏è Êû∂ÊûÑÂÆ°Êü• (5-10ÂàÜÈíü)" value="architecture">
                                        <span style="float: left">üèóÔ∏è Êû∂ÊûÑÂÆ°Êü•</span>
                                        <span style="float: right; color: #8492a6; font-size: 13px">5-10ÂàÜÈíü</span>
                                    </el-option>
                                </el-select>
                                <el-alert
                                    v-if="reviewForm.mode"
                                    :title="getModeDescription(reviewForm.mode)"
                                    type="info"
                                    :closable="false"
                                    style="margin-top: 10px">
                                </el-alert>
                            </el-form-item>

                            <el-form-item>
                                <el-button type="primary" @click="startReview" :loading="reviewLoading">
                                    ÂºÄÂßãReview
                                </el-button>
                            </el-form-item>
                        </el-form>

                        <div v-if="reviewResult" class="review-result">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <h4 style="margin: 0;">ReviewÁªìÊûúÔºö</h4>
                                <el-button-group v-if="currentReviewId">
                                    <el-button
                                        size="small"
                                        icon="el-icon-download"
                                        @click="exportMarkdown"
                                        :loading="exportLoading">
                                        ÂØºÂá∫ Markdown
                                    </el-button>
                                    <el-button
                                        size="small"
                                        icon="el-icon-document"
                                        @click="exportJson"
                                        :loading="exportLoading">
                                        ÂØºÂá∫ JSON
                                    </el-button>
                                </el-button-group>
                            </div>
                            <div v-html="renderedReviewResult"></div>
                        </div>
                    </div>
                </el-tab-pane>

                <el-tab-pane label="ÂçïÂÖÉÊµãËØïÁîüÊàê">
                    <div class="section">
                        <h3>Êô∫ËÉΩÂçïÂÖÉÊµãËØïÁîüÊàê</h3>

                        <el-form :model="testGenForm" label-width="120px">
                            <el-form-item label="ÈÄâÊã©‰ªìÂ∫ì">
                                <el-select v-model="testGenForm.repositoryId" placeholder="ËØ∑ÈÄâÊã©‰ªìÂ∫ì" @change="loadTestBranches">
                                    <el-option v-for="repo in repositories"
                                               :key="repo.id"
                                               :label="repo.name"
                                               :value="repo.id">
                                    </el-option>
                                </el-select>
                            </el-form-item>

                            <el-form-item label="ÂàÜÊîØ">
                                <el-select v-model="testGenForm.branch" placeholder="ËØ∑ÈÄâÊã©ÂàÜÊîØ" filterable allow-create>
                                    <el-option v-for="branch in testBranches"
                                               :key="'test-' + branch"
                                               :label="branch"
                                               :value="branch">
                                    </el-option>
                                </el-select>
                            </el-form-item>

                            <el-form-item label="JavaÁ±ªÂêç">
                                <el-input
                                    type="textarea"
                                    v-model="testGenForm.className"
                                    :rows="3"
                                    placeholder="‰æãÂ¶Ç: UserService Êàñ UserService,OrderService,ProductService (ÈÄóÂè∑ÂàÜÈöîÂ§ö‰∏™Á±ª)">
                                </el-input>
                                <div style="color: #909399; font-size: 12px; margin-top: 5px;">
                                    ÊîØÊåÅËæìÂÖ•Â§ö‰∏™Á±ªÂêçÔºå‰ΩøÁî®Ëã±ÊñáÈÄóÂè∑ÂàÜÈöî
                                </div>
                            </el-form-item>

                            <el-form-item label="ÂáÜÂÖ•ID">
                                <el-input v-model="testGenForm.gateId" placeholder="ÂèØÈÄâÔºåÊú™Â°´ÂÜôÂàô‰ªéGitÂéÜÂè≤ÊèêÂèñ">
                                    <template slot="prepend">Gate ID</template>
                                </el-input>
                                <div style="color: #909399; font-size: 12px; margin-top: 5px;">
                                    Â¶Ç‰∏çÂ°´ÂÜôÔºåÁ≥ªÁªüÂ∞ÜËá™Âä®‰ªéÊúÄËøëÁöÑGitÊèê‰∫§ÂéÜÂè≤‰∏≠ÊèêÂèñÂáÜÂÖ•ID
                                </div>
                            </el-form-item>

                            <el-form-item label="ÊµãËØïË¶ÅÊ±Ç">
                                <el-input
                                    type="textarea"
                                    v-model="testGenForm.requirement"
                                    :rows="4"
                                    placeholder="ÂèØÈÄâÔºåËæìÂÖ•ÂØπÊµãËØï‰ª£Á†ÅÁöÑÁâπÊÆäË¶ÅÊ±ÇÔºàÂ¶ÇÔºöÈúÄË¶ÅÊµãËØïËæπÁïåÊù°‰ª∂„ÄÅÈúÄË¶ÅË¶ÜÁõñÂºÇÂ∏∏Âú∫ÊôØÁ≠âÔºâ">
                                </el-input>
                                <div style="color: #909399; font-size: 12px; margin-top: 5px;">
                                    ÂèØÈÄâÂ°´ÂÜôÔºåÁïôÁ©∫Âàô‰ΩøÁî®ÈªòËÆ§ÁöÑMockÊµãËØïÊ†áÂáÜÔºàÂÆåÁæéË¥®ÈáèÔºâ
                                </div>
                            </el-form-item>

                            <el-form-item>
                                <el-button type="primary" @click="startTestGeneration" :loading="testGenLoading">
                                    ÁîüÊàêÊµãËØï‰ª£Á†Å
                                </el-button>
                                <el-button @click="resetTestForm">ÈáçÁΩÆ</el-button>
                            </el-form-item>
                        </el-form>

                        <!-- ËøõÂ∫¶ÊòæÁ§∫ -->
                        <div v-if="testGenProgress.show" class="test-progress">
                            <h4>ÁîüÊàêËøõÂ∫¶</h4>
                            <el-steps :active="testGenProgress.currentStep" finish-status="success">
                                <el-step title="ÂàÜÊûêÊ∫êÁ†Å" description="Ëß£ÊûêJavaÁ±ªÁªìÊûÑ"></el-step>
                                <el-step title="ÁîüÊàêÊµãËØï" description="Claude AIÁîüÊàêÊµãËØï‰ª£Á†Å"></el-step>
                                <el-step title="È™åËØÅÁºñËØë" description="Ê£ÄÊü•ÊµãËØï‰ª£Á†ÅËØ≠Ê≥ï"></el-step>
                                <el-step title="ÊâßË°åÊµãËØï" description="ËøêË°åÂπ∂È™åËØÅÊµãËØï"></el-step>
                            </el-steps>
                            <el-progress :percentage="testGenProgress.percentage"
                                        :status="testGenProgress.status"
                                        style="margin-top: 20px;">
                            </el-progress>
                            <div v-if="testGenProgress.message" style="margin-top: 10px; color: #666;">
                                {{ testGenProgress.message }}
                            </div>
                        </div>

                        <!-- ÁªìÊûúÂ±ïÁ§∫ -->
                        <div v-if="testGenResult.show" class="test-result">
                            <h4>ÁîüÊàêÁªìÊûú</h4>
                            <el-tabs type="card">
                                <el-tab-pane label="ÊµãËØï‰ª£Á†Å">
                                    <div class="code-container">
                                        <div class="code-header">
                                            <span>{{ testGenResult.testFileName }}</span>
                                            <div>
                                                <el-button size="mini" @click="copyTestCode">Â§çÂà∂‰ª£Á†Å</el-button>
                                                <el-button size="mini" type="primary" @click="downloadTestCode">‰∏ãËΩΩÊñá‰ª∂</el-button>
                                            </div>
                                        </div>
                                        <pre class="code-content"><code>{{ testGenResult.testCode }}</code></pre>
                                    </div>
                                </el-tab-pane>
                                <el-tab-pane label="ÊâßË°åÁªìÊûú">
                                    <el-descriptions border>
                                        <el-descriptions-item label="ÁºñËØëÁä∂ÊÄÅ">
                                            <el-tag :type="testGenResult.compilationSuccess ? 'success' : 'danger'">
                                                {{ testGenResult.compilationSuccess ? 'ÁºñËØëÊàêÂäü' : 'ÁºñËØëÂ§±Ë¥•' }}
                                            </el-tag>
                                        </el-descriptions-item>
                                        <el-descriptions-item label="ÊµãËØïÈÄöËøá">
                                            <el-tag :type="testGenResult.testsPass ? 'success' : 'warning'">
                                                {{ testGenResult.testsPass ? 'ÂÖ®ÈÉ®ÈÄöËøá' : 'ÈÉ®ÂàÜÂ§±Ë¥•' }}
                                            </el-tag>
                                        </el-descriptions-item>
                                        <el-descriptions-item label="Ë¶ÜÁõñÁéá">
                                            <span>{{ testGenResult.coveragePercentage }}%</span>
                                        </el-descriptions-item>
                                        <el-descriptions-item label="ÁîüÊàêÊó∂Èó¥">
                                            <span>{{ testGenResult.generationTime }}Áßí</span>
                                        </el-descriptions-item>
                                    </el-descriptions>
                                    <div v-if="testGenResult.output" class="test-output">
                                        <h5>ÊâßË°åËæìÂá∫Ôºö</h5>
                                        <pre>{{ testGenResult.output }}</pre>
                                    </div>
                                </el-tab-pane>
                            </el-tabs>
                        </div>
                    </div>
                </el-tab-pane>

                <el-tab-pane label="AIËæÖÂä©ÂºÄÂèë" name="workflow">
                    <div class="section">
                        <h3>AIËæÖÂä©ÂºÄÂèëÂ∑•‰ΩúÊµÅ</h3>
                        <el-button type="primary" @click="showCreateWorkflowDialog = true" icon="el-icon-plus">
                            ÂàõÂª∫Â∑•‰ΩúÊµÅ
                        </el-button>

                        <el-table :data="workflows" style="width: 100%; margin-top: 20px;" v-loading="workflowsLoading">
                            <el-table-column prop="name" label="Â∑•‰ΩúÊµÅÂêçÁß∞" width="200"></el-table-column>
                            <el-table-column label="Áä∂ÊÄÅ" width="150">
                                <template slot-scope="scope">
                                    <el-tag :type="getStatusType(scope.row.status)" size="small">
                                        {{ getStatusText(scope.row.status) }}
                                    </el-tag>
                                </template>
                            </el-table-column>
                            <el-table-column label="ËøõÂ∫¶" width="200">
                                <template slot-scope="scope">
                                    <el-progress :percentage="scope.row.progress" :color="getProgressColor(scope.row.progress)"></el-progress>
                                </template>
                            </el-table-column>
                            <el-table-column prop="currentStage" label="ÂΩìÂâçÈò∂ÊÆµ"></el-table-column>
                            <el-table-column label="ÂàõÂª∫Êó∂Èó¥" width="180">
                                <template slot-scope="scope">
                                    {{ formatDate(scope.row.createdAt) }}
                                </template>
                            </el-table-column>
                            <el-table-column label="Êìç‰Ωú" width="280">
                                <template slot-scope="scope">
                                    <el-button-group>
                                        <el-button size="mini" @click="viewWorkflowDetail(scope.row)" icon="el-icon-view">
                                            Êü•Áúã
                                        </el-button>
                                        <el-button size="mini" type="primary" @click="continueWorkflow(scope.row)"
                                                   :disabled="!canContinue(scope.row)" icon="el-icon-right">
                                            ÁªßÁª≠
                                        </el-button>
                                        <el-button size="mini" type="danger" @click="cancelWorkflow(scope.row)"
                                                   :disabled="!canCancel(scope.row)" icon="el-icon-close">
                                            ÂèñÊ∂à
                                        </el-button>
                                    </el-button-group>
                                </template>
                            </el-table-column>
                        </el-table>
                    </div>
                </el-tab-pane>
            </el-tabs>

            <!-- Ê∑ªÂä†‰ªìÂ∫ìÂØπËØùÊ°Ü -->
            <el-dialog title="Ê∑ªÂä†Git‰ªìÂ∫ì" :visible.sync="showAddDialog" width="500px">
                <el-form :model="newRepository" label-width="100px">
                    <el-form-item label="‰ªìÂ∫ìÂêçÁß∞">
                        <el-input v-model="newRepository.name"></el-input>
                    </el-form-item>
                    <el-form-item label="‰ªìÂ∫ìÂú∞ÂùÄ">
                        <el-input v-model="newRepository.url"></el-input>
                    </el-form-item>
                    <el-form-item label="Áî®Êà∑Âêç">
                        <el-input v-model="newRepository.username"></el-input>
                    </el-form-item>
                    <el-form-item label="ÂØÜÁ†Å">
                        <el-input v-model="newRepository.password" type="password"></el-input>
                    </el-form-item>
                    <el-form-item label="ÊèèËø∞">
                        <el-input v-model="newRepository.description" type="textarea"></el-input>
                    </el-form-item>
                </el-form>
                <span slot="footer" class="dialog-footer">
                    <el-button @click="showAddDialog = false">ÂèñÊ∂à</el-button>
                    <el-button type="primary" @click="addRepository">Á°ÆÂÆö</el-button>
                </span>
            </el-dialog>

            <!-- ÂàõÂª∫Â∑•‰ΩúÊµÅÂØπËØùÊ°Ü -->
            <el-dialog title="ÂàõÂª∫AIËæÖÂä©ÂºÄÂèëÂ∑•‰ΩúÊµÅ" :visible.sync="showCreateWorkflowDialog" width="700px">
                <el-form :model="newWorkflow" label-width="130px">
                    <el-form-item label="Â∑•‰ΩúÊµÅÂêçÁß∞">
                        <el-input v-model="newWorkflow.name" placeholder="‰æãÂ¶ÇÔºöÁî®Êà∑ÁôªÂΩïÂäüËÉΩÂºÄÂèë"></el-input>
                    </el-form-item>
                    <el-form-item label="ÈÄâÊã©‰ªìÂ∫ì">
                        <el-select v-model="newWorkflow.repositoryId" placeholder="ËØ∑ÈÄâÊã©‰ªìÂ∫ì" style="width: 100%">
                            <el-option v-for="repo in repositories"
                                       :key="repo.id"
                                       :label="repo.name"
                                       :value="repo.id">
                            </el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="PRDÂÜÖÂÆπ">
                        <el-input type="textarea" v-model="newWorkflow.prdContent" :rows="6"
                                  placeholder="ËØ∑ËæìÂÖ•‰∫ßÂìÅÈúÄÊ±ÇÊñáÊ°£ÂÜÖÂÆπ..."></el-input>
                    </el-form-item>

                    <el-divider>‰ª£Á†ÅÈ£éÊ†ºÈÖçÁΩÆÔºàÂèØÈÄâÔºâ</el-divider>

                    <el-form-item label="Êû∂ÊûÑÊ®°Âºè">
                        <el-select v-model="newWorkflow.architecture" placeholder="ÈªòËÆ§ÔºöDDD ÂÖ≠ËæπÂΩ¢Êû∂ÊûÑ" clearable style="width: 100%">
                            <el-option label="DDD ÂÖ≠ËæπÂΩ¢Êû∂ÊûÑÔºàDomain/Application/InfrastructureÔºâ" value="DDD ÂÖ≠ËæπÂΩ¢Êû∂ÊûÑÔºàDomain/Application/InfrastructureÔºâ"></el-option>
                            <el-option label="MVC ‰∏âÂ±ÇÊû∂ÊûÑÔºàController/Service/DAOÔºâ" value="MVC ‰∏âÂ±ÇÊû∂ÊûÑÔºàController/Service/DAOÔºâ"></el-option>
                            <el-option label="ÂàÜÂ±ÇÊû∂ÊûÑÔºàPresentation/Business/PersistenceÔºâ" value="ÂàÜÂ±ÇÊû∂ÊûÑÔºàPresentation/Business/PersistenceÔºâ"></el-option>
                            <el-option label="ÂæÆÊúçÂä°Êû∂ÊûÑÔºàAPI Gateway + Service MeshÔºâ" value="ÂæÆÊúçÂä°Êû∂ÊûÑÔºàAPI Gateway + Service MeshÔºâ"></el-option>
                            <el-option label="Clean ArchitectureÔºàÊï¥Ê¥ÅÊû∂ÊûÑÔºâ" value="Clean ArchitectureÔºàÊï¥Ê¥ÅÊû∂ÊûÑÔºâ"></el-option>
                        </el-select>
                    </el-form-item>

                    <el-form-item label="ÁºñÁ†ÅËßÑËåÉ">
                        <el-select v-model="newWorkflow.codingStyle" placeholder="ÈªòËÆ§ÔºöAlibaba-P3C" clearable style="width: 100%">
                            <el-option label="Alibaba-P3C ËßÑËåÉ" value="Alibaba-P3C ËßÑËåÉ"></el-option>
                            <el-option label="Google Java Style Guide" value="Google Java Style Guide"></el-option>
                            <el-option label="Spring Boot ÊúÄ‰Ω≥ÂÆûË∑µ" value="Spring Boot ÊúÄ‰Ω≥ÂÆûË∑µ"></el-option>
                            <el-option label="ÈòøÈáåÂ∑¥Â∑¥ÂæÆÊúçÂä°ËßÑËåÉ" value="ÈòøÈáåÂ∑¥Â∑¥ÂæÆÊúçÂä°ËßÑËåÉ"></el-option>
                        </el-select>
                    </el-form-item>

                    <el-form-item label="ÂëΩÂêçËßÑËåÉ">
                        <el-select v-model="newWorkflow.namingConvention" placeholder="ÈªòËÆ§ÔºöÈ©ºÂ≥∞ÂëΩÂêçÊ≥ï" clearable style="width: 100%">
                            <el-option label="È©ºÂ≥∞ÂëΩÂêçÊ≥ïÔºàcamelCaseÔºâ" value="È©ºÂ≥∞ÂëΩÂêçÊ≥ï"></el-option>
                            <el-option label="‰∏ãÂàíÁ∫øÂëΩÂêçÊ≥ïÔºàsnake_caseÔºâ" value="‰∏ãÂàíÁ∫øÂëΩÂêçÊ≥ï"></el-option>
                        </el-select>
                    </el-form-item>

                    <el-form-item label="Ê≥®ÈáäËØ≠Ë®Ä">
                        <el-select v-model="newWorkflow.commentLanguage" placeholder="ÈªòËÆ§Ôºö‰∏≠Êñá" clearable style="width: 100%">
                            <el-option label="‰∏≠Êñá" value="‰∏≠Êñá"></el-option>
                            <el-option label="Ëã±Êñá" value="Ëã±Êñá"></el-option>
                        </el-select>
                    </el-form-item>

                    <el-row :gutter="20">
                        <el-col :span="12">
                            <el-form-item label="ÊñπÊ≥ïÊúÄÂ§ßË°åÊï∞">
                                <el-input-number v-model="newWorkflow.maxMethodLines" :min="10" :max="100" placeholder="ÈªòËÆ§Ôºö50"></el-input-number>
                            </el-form-item>
                        </el-col>
                        <el-col :span="12">
                            <el-form-item label="ÂèÇÊï∞ÊúÄÂ§ß‰∏™Êï∞">
                                <el-input-number v-model="newWorkflow.maxParameters" :min="1" :max="10" placeholder="ÈªòËÆ§Ôºö5"></el-input-number>
                            </el-form-item>
                        </el-col>
                    </el-row>
                </el-form>
                <span slot="footer" class="dialog-footer">
                    <el-button @click="showCreateWorkflowDialog = false">ÂèñÊ∂à</el-button>
                    <el-button type="primary" @click="createWorkflow" :loading="createWorkflowLoading">ÂàõÂª∫Âπ∂ÁîüÊàêËßÑÊ†ºÊñáÊ°£</el-button>
                </span>
            </el-dialog>

            <!-- Â∑•‰ΩúÊµÅËØ¶ÊÉÖÂØπËØùÊ°Ü -->
            <el-dialog :title="'Â∑•‰ΩúÊµÅËØ¶ÊÉÖ - ' + (currentWorkflow.name || '')"
                       :visible.sync="showWorkflowDetailDialog"
                       width="90%"
                       top="5vh">
                <el-steps :active="getWorkflowStep(currentWorkflow.status)" finish-status="success" align-center>
                    <el-step title="ËßÑÊ†ºÊñáÊ°£" description="ÁîüÊàêspec.md"></el-step>
                    <el-step title="ÊäÄÊúØÊñπÊ°à" description="ËÆæËÆ°‰∏éÊâπÂáÜ"></el-step>
                    <el-step title="‰ªªÂä°ÂàóË°®" description="ÊãÜÂàÜ‰ªªÂä°"></el-step>
                    <el-step title="‰ª£Á†ÅÁîüÊàê" description="AIÁîüÊàê‰ª£Á†Å"></el-step>
                    <el-step title="ÂÆåÊàê" description="Â∑•‰ΩúÊµÅÁªìÊùü"></el-step>
                </el-steps>

                <el-tabs v-model="workflowDetailTab" style="margin-top: 20px;">
                    <!-- ËßÑÊ†ºÊñáÊ°£ -->
                    <el-tab-pane label="ËßÑÊ†ºÊñáÊ°£" name="spec">
                        <div v-if="currentWorkflow.specification">
                            <div style="margin-bottom: 15px;">
                                <el-button-group>
                                    <el-button size="small" icon="el-icon-refresh" @click="regenerateSpecification"
                                               :loading="specRegenerating"
                                               :disabled="currentWorkflow.status !== 'SPEC_GENERATED'">
                                        ÈáçÊñ∞ÁîüÊàêËßÑÊ†ºÊñáÊ°£
                                    </el-button>
                                    <el-button size="small" type="primary" @click="generateTechDesign"
                                               :loading="techDesignLoading"
                                               :disabled="currentWorkflow.status !== 'SPEC_GENERATED'">
                                        ÁîüÊàêÊäÄÊúØÊñπÊ°à
                                    </el-button>
                                </el-button-group>
                            </div>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>spec.md</span>
                                    <el-button size="mini" @click="copyContent(currentWorkflow.specification.content)">Â§çÂà∂</el-button>
                                </div>
                                <div class="code-content review-result" v-html="renderedSpecification"></div>
                            </div>
                        </div>
                        <el-empty v-else description="ËßÑÊ†ºÊñáÊ°£Êú™ÁîüÊàê"></el-empty>
                    </el-tab-pane>

                    <!-- ÊäÄÊúØÊñπÊ°à -->
                    <el-tab-pane label="ÊäÄÊúØÊñπÊ°à" name="techDesign">
                        <div v-if="currentWorkflow.technicalDesign">
                            <div style="margin-bottom: 15px;">
                                <el-button-group>
                                    <el-button size="small" @click="editTechDesign"
                                               :disabled="currentWorkflow.status !== 'TECH_DESIGN_GENERATED'">
                                        ÁºñËæëÊñπÊ°à
                                    </el-button>
                                    <el-button size="small" type="success" @click="approveTechDesign"
                                               :loading="approveLoading"
                                               :disabled="currentWorkflow.status !== 'TECH_DESIGN_GENERATED' || currentWorkflow.technicalDesign.approved">
                                        ÊâπÂáÜÊñπÊ°à
                                    </el-button>
                                    <el-button size="small" type="primary" @click="generateTaskList"
                                               :loading="taskListLoading"
                                               :disabled="currentWorkflow.status !== 'TECH_DESIGN_APPROVED'">
                                        ÁîüÊàê‰ªªÂä°ÂàóË°®
                                    </el-button>
                                </el-button-group>
                                <el-tag v-if="currentWorkflow.technicalDesign.approved" type="success" style="margin-left: 10px;">
                                    Â∑≤ÊâπÂáÜ (ÁâàÊú¨ {{ currentWorkflow.technicalDesign.version }})
                                </el-tag>
                            </div>
                            <div class="code-container">
                                <div class="code-header">
                                    <span>tech-design.md (ÁâàÊú¨: {{ currentWorkflow.technicalDesign.version }})</span>
                                    <el-button size="mini" @click="copyContent(currentWorkflow.technicalDesign.content)">Â§çÂà∂</el-button>
                                </div>
                                <div class="code-content review-result" v-html="renderedTechnicalDesign"></div>
                            </div>
                        </div>
                        <el-empty v-else description="ÊäÄÊúØÊñπÊ°àÊú™ÁîüÊàê"></el-empty>
                    </el-tab-pane>

                    <!-- ‰ªªÂä°ÂàóË°® -->
                    <el-tab-pane label="‰ªªÂä°ÂàóË°®" name="taskList">
                        <div v-if="currentWorkflow.taskList && currentWorkflow.taskList.tasks">
                            <div style="margin-bottom: 15px;">
                                <el-button size="small" type="primary" @click="startCodeGeneration"
                                           :loading="codeGenLoading"
                                           :disabled="currentWorkflow.status !== 'TASK_LIST_GENERATED'">
                                    ÂºÄÂßã‰ª£Á†ÅÁîüÊàê
                                </el-button>
                                <span style="margin-left: 15px; color: #666;">
                                    ËøõÂ∫¶: {{ currentWorkflow.taskList.completedTasks || 0 }} / {{ currentWorkflow.taskList.totalTasks || 0 }}
                                </span>
                            </div>
                            <el-table :data="currentWorkflow.taskList.tasks" style="width: 100%">
                                <el-table-column prop="id" label="‰ªªÂä°ID" width="100"></el-table-column>
                                <el-table-column prop="title" label="‰ªªÂä°Ê†áÈ¢ò"></el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="120">
                                    <template slot-scope="scope">
                                        <el-tag :type="getTaskStatusType(scope.row.status)" size="small">
                                            {{ getTaskStatusText(scope.row.status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="targetFile" label="ÁõÆÊ†áÊñá‰ª∂"></el-table-column>
                            </el-table>
                        </div>
                        <el-empty v-else description="‰ªªÂä°ÂàóË°®Êú™ÁîüÊàê"></el-empty>
                    </el-tab-pane>

                    <!-- ÁîüÊàê‰ª£Á†Å -->
                    <el-tab-pane label="ÁîüÊàê‰ª£Á†Å" name="code">
                        <div v-if="currentWorkflow.taskList && currentWorkflow.taskList.tasks">
                            <el-collapse accordion>
                                <el-collapse-item v-for="task in completedTasks" :key="task.id" :title="task.id + ' - ' + task.title">
                                    <div class="code-container">
                                        <div class="code-header">
                                            <span>{{ task.targetFile }}</span>
                                            <el-button size="mini" @click="copyContent(task.generatedCode)">Â§çÂà∂‰ª£Á†Å</el-button>
                                        </div>
                                        <pre class="code-content">{{ task.generatedCode }}</pre>
                                    </div>
                                </el-collapse-item>
                            </el-collapse>
                            <el-empty v-if="completedTasks.length === 0" description="ÊöÇÊó†Â∑≤ÁîüÊàêÁöÑ‰ª£Á†Å"></el-empty>
                        </div>
                        <el-empty v-else description="‰ªªÂä°ÂàóË°®Êú™ÁîüÊàê"></el-empty>
                    </el-tab-pane>
                </el-tabs>
            </el-dialog>

            <!-- ÁºñËæëÊäÄÊúØÊñπÊ°àÂØπËØùÊ°Ü -->
            <el-dialog title="ÁºñËæëÊäÄÊúØÊñπÊ°à" :visible.sync="showEditTechDesignDialog" width="80%">
                <el-input type="textarea" v-model="editingTechDesign" :rows="20"
                          placeholder="ÁºñËæëÊäÄÊúØÊñπÊ°àÂÜÖÂÆπ..."></el-input>
                <span slot="footer" class="dialog-footer">
                    <el-button @click="showEditTechDesignDialog = false">ÂèñÊ∂à</el-button>
                    <el-button type="primary" @click="saveTechDesign" :loading="saveTechDesignLoading">‰øùÂ≠ò</el-button>
                </span>
            </el-dialog>
        </div>
    </div>

    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    repositories: [],
                    branches: [],
                    testBranches: [],
                    reviewForm: {
                        repositoryId: '',
                        baseBranch: 'master',
                        targetBranch: '',
                        mode: 'deep'
                    },
                    testGenForm: {
                        repositoryId: '',
                        branch: 'master',
                        className: '',
                        gateId: '',
                        requirement: '',
                        testType: 'mock',
                        qualityLevel: 5
                    },
                    newRepository: {
                        name: '',
                        url: '',
                        username: '',
                        password: '',
                        description: ''
                    },
                    showAddDialog: false,
                    reviewLoading: false,
                    remoteLoading: false,
                    testGenLoading: false,
                    reviewResult: '',
                    currentReviewId: null,
                    exportLoading: false,
                    testGenProgress: {
                        show: false,
                        currentStep: 0,
                        percentage: 0,
                        status: '',
                        message: ''
                    },
                    testGenResult: {
                        show: false,
                        taskId: '',
                        testCode: '',
                        testFileName: '',
                        compilationSuccess: false,
                        testsPass: false,
                        coveragePercentage: 0,
                        generationTime: 0,
                        output: ''
                    },
                    // Â∑•‰ΩúÊµÅÁõ∏ÂÖ≥Êï∞ÊçÆ
                    activeTab: 'repos',
                    workflows: [],
                    workflowsLoading: false,
                    showCreateWorkflowDialog: false,
                    showWorkflowDetailDialog: false,
                    showEditTechDesignDialog: false,
                    createWorkflowLoading: false,
                    specRegenerating: false,
                    techDesignLoading: false,
                    approveLoading: false,
                    taskListLoading: false,
                    codeGenLoading: false,
                    saveTechDesignLoading: false,
                    newWorkflow: {
                        name: '',
                        repositoryId: '',
                        prdContent: '',
                        architecture: '',
                        codingStyle: '',
                        namingConvention: '',
                        commentLanguage: '',
                        maxMethodLines: null,
                        maxParameters: null
                    },
                    currentWorkflow: {},
                    workflowDetailTab: 'spec',
                    editingTechDesign: '',
                    workflowPollingTimer: null
                }
            },
            mounted() {
                this.loadRepositories();
                this.loadWorkflows();
            },
            beforeDestroy() {
                if (this.workflowPollingTimer) {
                    clearInterval(this.workflowPollingTimer);
                }
            },
            computed: {
                renderedReviewResult() {
                    if (!this.reviewResult) {
                        return '';
                    }
                    // ‰ΩøÁî® marked Â∫ìÊ∏≤Êüì Markdown
                    return marked.parse(this.reviewResult);
                },
                renderedSpecification() {
                    if (!this.currentWorkflow.specification || !this.currentWorkflow.specification.content) {
                        return '';
                    }
                    return marked.parse(this.currentWorkflow.specification.content);
                },
                renderedTechnicalDesign() {
                    if (!this.currentWorkflow.technicalDesign || !this.currentWorkflow.technicalDesign.content) {
                        return '';
                    }
                    return marked.parse(this.currentWorkflow.technicalDesign.content);
                },
                completedTasks() {
                    if (!this.currentWorkflow.taskList || !this.currentWorkflow.taskList.tasks) {
                        return [];
                    }
                    return this.currentWorkflow.taskList.tasks.filter(t => t.status === 'COMPLETED' && t.generatedCode);
                }
            },
            methods: {
                async loadRepositories() {
                    try {
                        const response = await axios.get('/api/repositories');
                        console.log('Loaded repositories:', response.data);
                        this.repositories = response.data;
                    } catch (error) {
                        console.error('Failed to load repositories:', error);
                        this.$message.error('Âä†ËΩΩ‰ªìÂ∫ìÂàóË°®Â§±Ë¥•');
                    }
                },
                
                async loadBranches() {
                    if (!this.reviewForm.repositoryId) return;
                    
                    try {
                        const response = await axios.get(`/api/git/${this.reviewForm.repositoryId}/branches`);
                        // ‰øÆÂ§çÔºöÊ≠£Á°ÆÂ§ÑÁêÜBranchListDTOÁöÑÊï∞ÊçÆÁªìÊûÑ
                        this.branches = response.data.branches || [];
                    } catch (error) {
                        this.$message.error('Âä†ËΩΩÂàÜÊîØÂàóË°®Â§±Ë¥•');
                    }
                },
                
                async loadRemoteBranches() {
                    if (!this.reviewForm.repositoryId) {
                        this.$message.warning('ËØ∑ÂÖàÈÄâÊã©‰ªìÂ∫ì');
                        return;
                    }
                    
                    this.remoteLoading = true;
                    try {
                        const response = await axios.get(`/api/repositories/${this.reviewForm.repositoryId}/remote-branches`);
                        // ‰øÆÂ§çÔºöÊ≠£Á°ÆÂ§ÑÁêÜBranchListDTOÁöÑÊï∞ÊçÆÁªìÊûÑ
                        this.branches = response.data.branches || [];
                        this.$message.success('ËøúÁ®ãÂàÜÊîØÂä†ËΩΩÊàêÂäü');
                    } catch (error) {
                        this.$message.error('Âä†ËΩΩËøúÁ®ãÂàÜÊîØÂ§±Ë¥•: ' + (error.response?.data || error.message));
                    } finally {
                        this.remoteLoading = false;
                    }
                },
                
                async addRepository() {
                    try {
                        const response = await axios.post('/api/repositories', this.newRepository);
                        console.log('Repository created:', response.data);
                        this.showAddDialog = false;
                        this.newRepository = { name: '', url: '', username: '', password: '', description: '' };
                        await this.loadRepositories();
                        this.$message.success('‰ªìÂ∫ìÊ∑ªÂä†ÊàêÂäü');
                    } catch (error) {
                        console.error('Failed to add repository:', error);
                        this.$message.error('Ê∑ªÂä†‰ªìÂ∫ìÂ§±Ë¥•: ' + (error.response?.data?.message || error.message));
                    }
                },
                
                async testConnection(repository) {
                    try {
                        await axios.post(`/api/repositories/${repository.id}/test-connection`);
                        this.$message.success('ËøûÊé•ÊµãËØïÊàêÂäü');
                    } catch (error) {
                        this.$message.error('ËøûÊé•ÊµãËØïÂ§±Ë¥•');
                    }
                },
                
                async deleteRepository(id) {
                    try {
                        await axios.delete(`/api/repositories/${id}`);
                        this.loadRepositories();
                        this.$message.success('Âà†Èô§ÊàêÂäü');
                    } catch (error) {
                        this.$message.error('Âà†Èô§Â§±Ë¥•');
                    }
                },
                
                async startReview() {
                    if (!this.reviewForm.repositoryId || !this.reviewForm.targetBranch) {
                        this.$message.warning('ËØ∑ÈÄâÊã©‰ªìÂ∫ìÂíåÂàÜÊîØ');
                        return;
                    }

                    this.reviewLoading = true;
                    this.reviewResult = '';
                    this.currentReviewId = null;

                    try {
                        // ‰øÆÂ§çÔºö‰ΩøÁî®POSTËØ∑Ê±ÇÂπ∂ÈÄöËøáFormData‰º†ÈÄíÂèÇÊï∞
                        const params = new URLSearchParams();
                        params.append('baseBranch', this.reviewForm.baseBranch);
                        params.append('targetBranch', this.reviewForm.targetBranch);
                        params.append('mode', this.reviewForm.mode);

                        const response = await axios.post(
                            `/api/review/${this.reviewForm.repositoryId}/claude`,
                            params,
                            {
                                headers: {
                                    'Content-Type': 'application/x-www-form-urlencoded'
                                }
                            }
                        );
                        this.reviewResult = response.data;
                        // ‰ΩøÁî®repositoryId‰Ωú‰∏∫‰∏¥Êó∂ÁöÑreviewIdÔºàÁî®‰∫éÊñá‰ª∂ÂëΩÂêçÔºâ
                        this.currentReviewId = this.reviewForm.repositoryId;
                        this.$message.success('ReviewÂÆåÊàê');
                    } catch (error) {
                        this.$message.error('ReviewÂ§±Ë¥•: ' + (error.response?.data || error.message));
                    } finally {
                        this.reviewLoading = false;
                    }
                },

                // Ëé∑ÂèñÂÆ°Êü•Ê®°ÂºèËØ¥Êòé
                getModeDescription(mode) {
                    const descriptions = {
                        'quick': 'Âø´ÈÄüÂÆ°Êü•Ôºö‰ªÖÂÖ≥Ê≥®ÂÖ≥ÈîÆBug„ÄÅÂÆâÂÖ®ÊºèÊ¥ûÂíå‰∏•ÈáçÊÄßËÉΩÈóÆÈ¢òÔºåÈÄÇÂêàÊó•Â∏∏PRÂÆ°Êü•',
                        'standard': 'Ê†áÂáÜÂÆ°Êü•ÔºöÂπ≥Ë°°ÁöÑÂÆ°Êü•Ê∑±Â∫¶ÔºåË¶ÜÁõñÂ∏∏ËßÅÁöÑ‰ª£Á†ÅË¥®ÈáèÈóÆÈ¢òÔºåÈÄÇÂêàÂäüËÉΩÂêàÂπ∂ÂâçÊ£ÄÊü•',
                        'deep': 'Ê∑±Â∫¶ÂÆ°Êü•ÔºöÂÖ®Èù¢Ê∑±ÂÖ•ÁöÑÂÆ°Êü•ÔºåÂåÖÂê´ËØ¶ÁªÜÁöÑÈóÆÈ¢òÂàÜÁ∫ß(P0-P3)„ÄÅ‰øÆÂ§çÂª∫ËÆÆÂíå‰ª£Á†ÅÁ§∫‰æãÔºåÈÄÇÂêàÁâàÊú¨ÂèëÂ∏ÉÂâçÁöÑ‰∏•Ê†ºÂÆ°Êü•',
                        'security': 'ÂÆâÂÖ®ÂÆ°Êü•Ôºö‰∏ìÊ≥®‰∫éÂÆâÂÖ®ÊºèÊ¥ûÊ£ÄÊµãÔºåÂåÖÊã¨SQLÊ≥®ÂÖ•„ÄÅXSS„ÄÅCSRF„ÄÅËÆ§ËØÅÊéàÊùÉÁ≠âÈóÆÈ¢ò',
                        'performance': 'ÊÄßËÉΩÂÆ°Êü•Ôºö‰∏ìÊ≥®‰∫éÊÄßËÉΩÈóÆÈ¢òÔºåÂåÖÊã¨N+1Êü•ËØ¢„ÄÅÊÖ¢SQL„ÄÅÂÜÖÂ≠òÊ≥ÑÊºè„ÄÅËµÑÊ∫êÊú™ÂÖ≥Èó≠Á≠â',
                        'architecture': 'Êû∂ÊûÑÂÆ°Êü•ÔºöÂÖ≥Ê≥®Êû∂ÊûÑËÆæËÆ°ÔºåÂåÖÊã¨ÂàÜÂ±ÇËÄ¶Âêà„ÄÅSOLIDÂéüÂàô„ÄÅËÆæËÆ°Ê®°ÂºèÂ∫îÁî®Á≠â'
                    };
                    return descriptions[mode] || '';
                },

                // ÂØºÂá∫MarkdownÊ†ºÂºèÊä•Âëä
                async exportMarkdown() {
                    if (!this.reviewResult) {
                        this.$message.warning('Ê≤°ÊúâÂèØÂØºÂá∫ÁöÑÂÆ°Êü•ÁªìÊûú');
                        return;
                    }

                    this.exportLoading = true;
                    try {
                        // ÂàõÂª∫MarkdownÂÜÖÂÆπ
                        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                        const filename = `review-${this.currentReviewId}-${timestamp}.md`;

                        // ÊûÑÂª∫ÂÆåÊï¥ÁöÑMarkdownÂÜÖÂÆπ
                        const repoName = this.repositories.find(r => r.id === this.reviewForm.repositoryId)?.name || 'Unknown';
                        const markdown = `# ‰ª£Á†ÅÂÆ°Êü•Êä•Âëä

## Âü∫Êú¨‰ø°ÊÅØ

- **‰ªìÂ∫ì**: ${repoName}
- **ÂàÜÊîØ**: ${this.reviewForm.baseBranch} ‚Üí ${this.reviewForm.targetBranch}
- **ÂÆ°Êü•Êó∂Èó¥**: ${new Date().toLocaleString('zh-CN')}

---

## ÂÆ°Êü•ÁªìÊûú

${this.reviewResult}

---

**Êä•ÂëäÁîüÊàêÊó∂Èó¥**: ${new Date().toLocaleString('zh-CN')}
**ÁîüÊàêÂ∑•ÂÖ∑**: Git Review Service
`;

                        // ÂàõÂª∫BlobÂπ∂‰∏ãËΩΩ
                        const blob = new Blob([markdown], { type: 'text/markdown;charset=utf-8' });
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = filename;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        window.URL.revokeObjectURL(url);

                        this.$message.success('MarkdownÊä•ÂëäÂ∑≤ÂØºÂá∫');
                    } catch (error) {
                        this.$message.error('ÂØºÂá∫Â§±Ë¥•: ' + error.message);
                    } finally {
                        this.exportLoading = false;
                    }
                },

                // ÂØºÂá∫JSONÊ†ºÂºèÊä•Âëä
                async exportJson() {
                    if (!this.reviewResult) {
                        this.$message.warning('Ê≤°ÊúâÂèØÂØºÂá∫ÁöÑÂÆ°Êü•ÁªìÊûú');
                        return;
                    }

                    this.exportLoading = true;
                    try {
                        const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                        const filename = `review-${this.currentReviewId}-${timestamp}.json`;

                        const repoName = this.repositories.find(r => r.id === this.reviewForm.repositoryId)?.name || 'Unknown';

                        // ÊûÑÂª∫JSONÊï∞ÊçÆ
                        const jsonData = {
                            reviewId: this.currentReviewId,
                            repository: {
                                id: this.reviewForm.repositoryId,
                                name: repoName
                            },
                            branches: {
                                base: this.reviewForm.baseBranch,
                                target: this.reviewForm.targetBranch
                            },
                            reviewTime: new Date().toISOString(),
                            result: this.reviewResult,
                            metadata: {
                                generatedBy: 'Git Review Service',
                                version: '1.0.0'
                            }
                        };

                        // ÂàõÂª∫BlobÂπ∂‰∏ãËΩΩ
                        const blob = new Blob([JSON.stringify(jsonData, null, 2)], {
                            type: 'application/json;charset=utf-8'
                        });
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = filename;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        window.URL.revokeObjectURL(url);

                        this.$message.success('JSONÊä•ÂëäÂ∑≤ÂØºÂá∫');
                    } catch (error) {
                        this.$message.error('ÂØºÂá∫Â§±Ë¥•: ' + error.message);
                    } finally {
                        this.exportLoading = false;
                    }
                },

                // ÊµãËØïÁîüÊàêÁõ∏ÂÖ≥ÊñπÊ≥ï
                async loadTestBranches() {
                    if (!this.testGenForm.repositoryId) return;

                    try {
                        const response = await axios.get(`/api/git/${this.testGenForm.repositoryId}/branches`);
                        // ‰øÆÂ§çÔºöÊ≠£Á°ÆÂ§ÑÁêÜBranchListDTOÁöÑÊï∞ÊçÆÁªìÊûÑ
                        this.testBranches = response.data.branches || [];
                    } catch (error) {
                        this.$message.error('Âä†ËΩΩÂàÜÊîØÂàóË°®Â§±Ë¥•');
                    }
                },

                formatQualityTooltip(val) {
                    const levels = {
                        1: 'Âü∫Á°Ä',
                        2: 'ËâØÂ•Ω',
                        3: 'Ê†áÂáÜ',
                        4: 'È´òË¥®Èáè',
                        5: 'ÂÆåÁæé'
                    };
                    return levels[val] || 'Ê†áÂáÜ';
                },

                resetTestForm() {
                    this.testGenForm = {
                        repositoryId: '',
                        branch: 'master',
                        className: '',
                        gateId: '',
                        requirement: '',
                        testType: 'mock',
                        qualityLevel: 5
                    };
                    this.testGenProgress.show = false;
                    this.testGenResult.show = false;
                },

                async startTestGeneration() {
                    if (!this.testGenForm.repositoryId || !this.testGenForm.branch || !this.testGenForm.className) {
                        this.$message.warning('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ');
                        return;
                    }

                    this.testGenLoading = true;
                    this.testGenProgress.show = true;
                    this.testGenProgress.currentStep = 0;
                    this.testGenProgress.percentage = 0;
                    this.testGenProgress.status = 'active';
                    this.testGenProgress.message = 'Ê≠£Âú®ÂàÜÊûêÊ∫êÁ†Å...';
                    this.testGenResult.show = false;

                    try {
                        // Ë∞ÉÁî®ÊµãËØïÁîüÊàêAPI
                        const response = await axios.post('/api/test-generation/generate', {
                            repositoryId: this.testGenForm.repositoryId,
                            branch: this.testGenForm.branch,
                            className: this.testGenForm.className,
                            gateId: this.testGenForm.gateId,
                            requirement: this.testGenForm.requirement,
                            testType: this.testGenForm.testType,
                            qualityLevel: this.testGenForm.qualityLevel
                        });

                        const taskId = response.data.taskId;

                        // ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ
                        await this.pollTaskStatus(taskId);

                    } catch (error) {
                        this.testGenProgress.status = 'exception';
                        this.testGenProgress.message = 'ÁîüÊàêÂ§±Ë¥•: ' + (error.response?.data?.message || error.message);
                        this.$message.error('ÊµãËØïÁîüÊàêÂ§±Ë¥•');
                    } finally {
                        this.testGenLoading = false;
                    }
                },

                async pollTaskStatus(taskId) {
                    const pollInterval = 2000; // 2ÁßíËΩÆËØ¢‰∏ÄÊ¨°
                    const maxPolls = 150; // ÊúÄÂ§öËΩÆËØ¢5ÂàÜÈíü
                    let pollCount = 0;

                    const poll = async () => {
                        if (pollCount >= maxPolls) {
                            this.testGenProgress.status = 'exception';
                            this.testGenProgress.message = 'ÁîüÊàêË∂ÖÊó∂';
                            return;
                        }

                        try {
                            const response = await axios.get(`/api/test-generation/status/${taskId}`);
                            const status = response.data;

                            // Êõ¥Êñ∞ËøõÂ∫¶
                            this.updateProgress(status);

                            if (status.status === 'COMPLETED') {
                                // Ëé∑ÂèñÊúÄÁªàÁªìÊûú
                                await this.loadFinalResult(taskId);
                                return;
                            } else if (status.status === 'FAILED') {
                                this.testGenProgress.status = 'exception';
                                this.testGenProgress.message = 'ÁîüÊàêÂ§±Ë¥•: ' + status.message;
                                return;
                            }

                            // ÁªßÁª≠ËΩÆËØ¢
                            pollCount++;
                            setTimeout(poll, pollInterval);

                        } catch (error) {
                            this.testGenProgress.status = 'exception';
                            this.testGenProgress.message = 'Áä∂ÊÄÅÊü•ËØ¢Â§±Ë¥•';
                        }
                    };

                    await poll();
                },

                updateProgress(status) {
                    const stepMap = {
                        'ANALYZING': { step: 0, message: 'Ê≠£Âú®ÂàÜÊûêJavaÁ±ªÁªìÊûÑ...', percentage: 25 },
                        'GENERATING': { step: 1, message: 'Ê≠£Âú®ÁîüÊàêÊµãËØï‰ª£Á†Å...', percentage: 50 },
                        'COMPILING': { step: 2, message: 'Ê≠£Âú®È™åËØÅÁºñËØë...', percentage: 75 },
                        'TESTING': { step: 3, message: 'Ê≠£Âú®ÊâßË°åÊµãËØï...', percentage: 90 },
                        'COMPLETED': { step: 4, message: 'ÁîüÊàêÂÆåÊàê', percentage: 100 }
                    };

                    const progress = stepMap[status.status] || { step: 0, message: status.message, percentage: 0 };

                    this.testGenProgress.currentStep = progress.step;
                    this.testGenProgress.percentage = progress.percentage;
                    this.testGenProgress.message = progress.message;

                    if (status.status === 'COMPLETED') {
                        this.testGenProgress.status = 'success';
                    }
                },

                async loadFinalResult(taskId) {
                    try {
                        const response = await axios.get(`/api/test-generation/result/${taskId}`);
                        const result = response.data;

                        this.testGenResult = {
                            show: true,
                            taskId: taskId,
                            testCode: result.testCode,
                            testFileName: result.testFileName,
                            compilationSuccess: result.compilationSuccess,
                            testsPass: result.testsPass,
                            coveragePercentage: result.coveragePercentage || 0,
                            generationTime: result.generationTime || 0,
                            output: result.output || ''
                        };

                        this.$message.success('ÊµãËØï‰ª£Á†ÅÁîüÊàêÂÆåÊàêÔºÅ');
                    } catch (error) {
                        this.$message.error('Ëé∑ÂèñÁªìÊûúÂ§±Ë¥•');
                    }
                },

                copyTestCode() {
                    if (!this.testGenResult.testCode) return;

                    // ÂàõÂª∫‰∏¥Êó∂textareaÂÖÉÁ¥†Â§çÂà∂ÊñáÊú¨
                    const textarea = document.createElement('textarea');
                    textarea.value = this.testGenResult.testCode;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);

                    this.$message.success('‰ª£Á†ÅÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                },

                downloadTestCode() {
                    if (!this.testGenResult.testCode) return;

                    const blob = new Blob([this.testGenResult.testCode], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = this.testGenResult.testFileName || 'TestClass.java';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);

                    this.$message.success('Êñá‰ª∂‰∏ãËΩΩÂÆåÊàê');
                },

                // ========== Â∑•‰ΩúÊµÅÁõ∏ÂÖ≥ÊñπÊ≥ï ==========
                async loadWorkflows() {
                    this.workflowsLoading = true;
                    try {
                        const response = await axios.get('/api/workflow');
                        this.workflows = response.data;
                    } catch (error) {
                        this.$message.error('Âä†ËΩΩÂ∑•‰ΩúÊµÅÂàóË°®Â§±Ë¥•');
                    } finally {
                        this.workflowsLoading = false;
                    }
                },

                async createWorkflow() {
                    if (!this.newWorkflow.name || !this.newWorkflow.repositoryId || !this.newWorkflow.prdContent) {
                        this.$message.warning('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´È°π');
                        return;
                    }

                    this.createWorkflowLoading = true;
                    try {
                        // 1. ÂàõÂª∫Â∑•‰ΩúÊµÅÔºàÂåÖÂê´‰ª£Á†ÅÈ£éÊ†ºÈÖçÁΩÆÔºâ
                        const createPayload = {
                            name: this.newWorkflow.name,
                            repositoryId: this.newWorkflow.repositoryId,
                            createdBy: 'user'
                        };

                        // Ê∑ªÂä†ÂèØÈÄâÁöÑ‰ª£Á†ÅÈ£éÊ†ºÈÖçÁΩÆ
                        if (this.newWorkflow.architecture) {
                            createPayload.architecture = this.newWorkflow.architecture;
                        }
                        if (this.newWorkflow.codingStyle) {
                            createPayload.codingStyle = this.newWorkflow.codingStyle;
                        }
                        if (this.newWorkflow.namingConvention) {
                            createPayload.namingConvention = this.newWorkflow.namingConvention;
                        }
                        if (this.newWorkflow.commentLanguage) {
                            createPayload.commentLanguage = this.newWorkflow.commentLanguage;
                        }
                        if (this.newWorkflow.maxMethodLines) {
                            createPayload.maxMethodLines = this.newWorkflow.maxMethodLines;
                        }
                        if (this.newWorkflow.maxParameters) {
                            createPayload.maxParameters = this.newWorkflow.maxParameters;
                        }

                        const createRes = await axios.post('/api/workflow', createPayload);
                        const workflowId = createRes.data.workflowId;

                        // 2. ÁîüÊàêËßÑÊ†ºÊñáÊ°£
                        await axios.post(`/api/workflow/${workflowId}/spec/generate`, {
                            prdContent: this.newWorkflow.prdContent,
                            documentPaths: []
                        });

                        this.$message.success('Â∑•‰ΩúÊµÅÂàõÂª∫ÊàêÂäüÔºåÊ≠£Âú®ÁîüÊàêËßÑÊ†ºÊñáÊ°£...');
                        this.showCreateWorkflowDialog = false;
                        this.newWorkflow = {
                            name: '',
                            repositoryId: '',
                            prdContent: '',
                            architecture: '',
                            codingStyle: '',
                            namingConvention: '',
                            commentLanguage: '',
                            maxMethodLines: null,
                            maxParameters: null
                        };

                        // Âà∑Êñ∞ÂàóË°®
                        await this.loadWorkflows();

                        // ÂºÄÂêØËΩÆËØ¢
                        this.startPollingWorkflow(workflowId);
                    } catch (error) {
                        this.$message.error('ÂàõÂª∫Â∑•‰ΩúÊµÅÂ§±Ë¥•: ' + (error.response?.data?.message || error.message));
                    } finally {
                        this.createWorkflowLoading = false;
                    }
                },

                async viewWorkflowDetail(workflow) {
                    try {
                        // Ëé∑ÂèñÂÆåÊï¥ÁöÑÂ∑•‰ΩúÊµÅËØ¶ÊÉÖ
                        const promises = [
                            axios.get(`/api/workflow/${workflow.id}/status`)
                        ];

                        // Ê†πÊçÆÁä∂ÊÄÅËé∑Âèñ‰∏çÂêåÁöÑÊï∞ÊçÆ
                        if (workflow.status !== 'DRAFT' && workflow.status !== 'SPEC_GENERATING') {
                            promises.push(axios.get(`/api/workflow/${workflow.id}/spec`).catch(() => null));
                        }
                        if (['TECH_DESIGN_GENERATED', 'TECH_DESIGN_APPROVED', 'TASK_LIST_GENERATING', 'TASK_LIST_GENERATED', 'CODE_GENERATING', 'COMPLETED'].includes(workflow.status)) {
                            promises.push(axios.get(`/api/workflow/${workflow.id}/tech-design`).catch(() => null));
                        }
                        if (['TASK_LIST_GENERATED', 'CODE_GENERATING', 'COMPLETED'].includes(workflow.status)) {
                            promises.push(axios.get(`/api/workflow/${workflow.id}/tasklist`).catch(() => null));
                        }

                        const results = await Promise.all(promises);

                        this.currentWorkflow = {
                            ...results[0].data,
                            specification: results[1]?.data || null,
                            technicalDesign: results[2]?.data || null,
                            taskList: results[3]?.data || null
                        };

                        this.showWorkflowDetailDialog = true;

                        // Â¶ÇÊûúÂ∑•‰ΩúÊµÅÊ≠£Âú®ËøõË°å‰∏≠ÔºåÂºÄÂêØËΩÆËØ¢
                        if (!['COMPLETED', 'FAILED', 'CANCELLED'].includes(workflow.status)) {
                            this.startPollingWorkflow(workflow.id);
                        }
                    } catch (error) {
                        this.$message.error('Ëé∑ÂèñÂ∑•‰ΩúÊµÅËØ¶ÊÉÖÂ§±Ë¥•');
                    }
                },

                continueWorkflow(workflow) {
                    this.viewWorkflowDetail(workflow);
                },

                async cancelWorkflow(workflow) {
                    try {
                        await this.$confirm('Á°ÆÂÆöË¶ÅÂèñÊ∂àËØ•Â∑•‰ΩúÊµÅÂêóÔºü', 'ÊèêÁ§∫', {
                            confirmButtonText: 'Á°ÆÂÆö',
                            cancelButtonText: 'ÂèñÊ∂à',
                            type: 'warning'
                        });

                        await axios.post(`/api/workflow/${workflow.id}/cancel`, { reason: 'Áî®Êà∑ÊâãÂä®ÂèñÊ∂à' });
                        this.$message.success('Â∑•‰ΩúÊµÅÂ∑≤ÂèñÊ∂à');
                        await this.loadWorkflows();
                    } catch (error) {
                        if (error !== 'cancel') {
                            this.$message.error('ÂèñÊ∂àÂ∑•‰ΩúÊµÅÂ§±Ë¥•');
                        }
                    }
                },

                async regenerateSpecification() {
                    try {
                        const result = await this.$confirm('Á°ÆËÆ§ÈáçÊñ∞ÁîüÊàêËßÑÊ†ºÊñáÊ°£ÂêóÔºüÂ∞Ü‰ΩøÁî®ÂéüÊúâPRDÂÜÖÂÆπÈáçÊñ∞ÁîüÊàê„ÄÇ', 'ÊèêÁ§∫', {
                            confirmButtonText: 'Á°ÆÂÆö',
                            cancelButtonText: 'ÂèñÊ∂à',
                            type: 'warning'
                        });

                        this.specRegenerating = true;
                        await axios.post(`/api/workflow/${this.currentWorkflow.id}/spec/generate`, {
                            prdContent: this.currentWorkflow.specification.prdContent,
                            documentPaths: this.currentWorkflow.specification.documentPaths || []
                        });
                        this.$message.success('ËßÑÊ†ºÊñáÊ°£ÈáçÊñ∞ÁîüÊàê‰∏≠ÔºåËØ∑Á®çÂÄô...');
                        this.startPollingWorkflow(this.currentWorkflow.id);
                    } catch (error) {
                        if (error !== 'cancel') {
                            this.$message.error('ÈáçÊñ∞ÁîüÊàêËßÑÊ†ºÊñáÊ°£Â§±Ë¥•');
                        }
                    } finally {
                        this.specRegenerating = false;
                    }
                },

                async generateTechDesign() {
                    this.techDesignLoading = true;
                    try {
                        await axios.post(`/api/workflow/${this.currentWorkflow.id}/tech-design/generate`);
                        this.$message.success('ÊäÄÊúØÊñπÊ°àÁîüÊàê‰∏≠ÔºåËØ∑Á®çÂÄô...');
                        this.startPollingWorkflow(this.currentWorkflow.id);
                    } catch (error) {
                        this.$message.error('ÁîüÊàêÊäÄÊúØÊñπÊ°àÂ§±Ë¥•');
                    } finally {
                        this.techDesignLoading = false;
                    }
                },

                editTechDesign() {
                    this.editingTechDesign = this.currentWorkflow.technicalDesign.content;
                    this.showEditTechDesignDialog = true;
                },

                async saveTechDesign() {
                    this.saveTechDesignLoading = true;
                    try {
                        await axios.put(`/api/workflow/${this.currentWorkflow.id}/tech-design`, {
                            content: this.editingTechDesign
                        });
                        this.$message.success('ÊäÄÊúØÊñπÊ°àÂ∑≤Êõ¥Êñ∞');
                        this.showEditTechDesignDialog = false;
                        await this.viewWorkflowDetail(this.currentWorkflow);
                    } catch (error) {
                        this.$message.error('‰øùÂ≠òÂ§±Ë¥•');
                    } finally {
                        this.saveTechDesignLoading = false;
                    }
                },

                async approveTechDesign() {
                    this.approveLoading = true;
                    try {
                        await axios.post(`/api/workflow/${this.currentWorkflow.id}/tech-design/approve`);
                        this.$message.success('ÊäÄÊúØÊñπÊ°àÂ∑≤ÊâπÂáÜ');
                        await this.viewWorkflowDetail(this.currentWorkflow);
                    } catch (error) {
                        this.$message.error('ÊâπÂáÜÂ§±Ë¥•');
                    } finally {
                        this.approveLoading = false;
                    }
                },

                async generateTaskList() {
                    this.taskListLoading = true;
                    try {
                        await axios.post(`/api/workflow/${this.currentWorkflow.id}/tasklist/generate`);
                        this.$message.success('‰ªªÂä°ÂàóË°®ÁîüÊàê‰∏≠ÔºåËØ∑Á®çÂÄô...');
                        this.startPollingWorkflow(this.currentWorkflow.id);
                    } catch (error) {
                        this.$message.error('ÁîüÊàê‰ªªÂä°ÂàóË°®Â§±Ë¥•');
                    } finally {
                        this.taskListLoading = false;
                    }
                },

                async startCodeGeneration() {
                    this.codeGenLoading = true;
                    try {
                        await axios.post(`/api/workflow/${this.currentWorkflow.id}/code-generation/start`);
                        this.$message.success('‰ª£Á†ÅÁîüÊàê‰∏≠ÔºåËØ∑Á®çÂÄô...');
                        this.startPollingWorkflow(this.currentWorkflow.id);
                    } catch (error) {
                        this.$message.error('ÂºÄÂßã‰ª£Á†ÅÁîüÊàêÂ§±Ë¥•');
                    } finally {
                        this.codeGenLoading = false;
                    }
                },

                startPollingWorkflow(workflowId) {
                    if (this.workflowPollingTimer) {
                        clearInterval(this.workflowPollingTimer);
                    }

                    this.workflowPollingTimer = setInterval(async () => {
                        try {
                            const res = await axios.get(`/api/workflow/${workflowId}/status`);
                            const status = res.data.status;

                            // Êõ¥Êñ∞ÂàóË°®
                            await this.loadWorkflows();

                            // Â¶ÇÊûúËØ¶ÊÉÖÂØπËØùÊ°ÜÊâìÂºÄ‰∏îÊòØÂΩìÂâçÂ∑•‰ΩúÊµÅÔºåÂàôÂà∑Êñ∞ËØ¶ÊÉÖ
                            if (this.showWorkflowDetailDialog && this.currentWorkflow.id === workflowId) {
                                await this.viewWorkflowDetail({ id: workflowId, status });
                            }

                            // Â¶ÇÊûúÂ∑≤ÂÆåÊàêÔºåÂÅúÊ≠¢ËΩÆËØ¢
                            if (['COMPLETED', 'FAILED', 'CANCELLED'].includes(status)) {
                                clearInterval(this.workflowPollingTimer);
                                this.workflowPollingTimer = null;
                            }
                        } catch (error) {
                            console.error('ËΩÆËØ¢Â∑•‰ΩúÊµÅÁä∂ÊÄÅÂ§±Ë¥•', error);
                        }
                    }, 3000);
                },

                copyContent(content) {
                    const textarea = document.createElement('textarea');
                    textarea.value = content;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    this.$message.success('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                },

                getStatusType(status) {
                    const typeMap = {
                        'DRAFT': 'info',
                        'SPEC_GENERATING': 'warning',
                        'SPEC_GENERATED': 'success',
                        'TECH_DESIGN_GENERATING': 'warning',
                        'TECH_DESIGN_GENERATED': 'success',
                        'TECH_DESIGN_APPROVED': 'success',
                        'TASK_LIST_GENERATING': 'warning',
                        'TASK_LIST_GENERATED': 'success',
                        'CODE_GENERATING': 'warning',
                        'COMPLETED': 'success',
                        'FAILED': 'danger',
                        'CANCELLED': 'info'
                    };
                    return typeMap[status] || 'info';
                },

                getStatusText(status) {
                    const textMap = {
                        'DRAFT': 'ËçâÁ®ø',
                        'SPEC_GENERATING': 'ÁîüÊàêËßÑÊ†ºÊñáÊ°£‰∏≠',
                        'SPEC_GENERATED': 'ËßÑÊ†ºÊñáÊ°£Â∑≤ÁîüÊàê',
                        'TECH_DESIGN_GENERATING': 'ÁîüÊàêÊäÄÊúØÊñπÊ°à‰∏≠',
                        'TECH_DESIGN_GENERATED': 'ÊäÄÊúØÊñπÊ°àÂ∑≤ÁîüÊàê',
                        'TECH_DESIGN_APPROVED': 'ÊäÄÊúØÊñπÊ°àÂ∑≤ÊâπÂáÜ',
                        'TASK_LIST_GENERATING': 'ÁîüÊàê‰ªªÂä°ÂàóË°®‰∏≠',
                        'TASK_LIST_GENERATED': '‰ªªÂä°ÂàóË°®Â∑≤ÁîüÊàê',
                        'CODE_GENERATING': '‰ª£Á†ÅÁîüÊàê‰∏≠',
                        'COMPLETED': 'Â∑≤ÂÆåÊàê',
                        'FAILED': 'Â§±Ë¥•',
                        'CANCELLED': 'Â∑≤ÂèñÊ∂à'
                    };
                    return textMap[status] || status;
                },

                getTaskStatusType(status) {
                    const typeMap = {
                        'PENDING': 'info',
                        'IN_PROGRESS': 'warning',
                        'COMPLETED': 'success',
                        'FAILED': 'danger',
                        'SKIPPED': 'info'
                    };
                    return typeMap[status] || 'info';
                },

                getTaskStatusText(status) {
                    const textMap = {
                        'PENDING': 'ÂæÖÊâßË°å',
                        'IN_PROGRESS': 'ËøõË°å‰∏≠',
                        'COMPLETED': 'Â∑≤ÂÆåÊàê',
                        'FAILED': 'Â§±Ë¥•',
                        'SKIPPED': 'Â∑≤Ë∑≥Ëøá'
                    };
                    return textMap[status] || status;
                },

                getProgressColor(percentage) {
                    if (percentage < 30) return '#f56c6c';
                    if (percentage < 70) return '#e6a23c';
                    return '#67c23a';
                },

                getWorkflowStep(status) {
                    const stepMap = {
                        'DRAFT': 0,
                        'SPEC_GENERATING': 0,
                        'SPEC_GENERATED': 1,
                        'TECH_DESIGN_GENERATING': 1,
                        'TECH_DESIGN_GENERATED': 2,
                        'TECH_DESIGN_APPROVED': 2,
                        'TASK_LIST_GENERATING': 2,
                        'TASK_LIST_GENERATED': 3,
                        'CODE_GENERATING': 3,
                        'COMPLETED': 4,
                        'FAILED': -1,
                        'CANCELLED': -1
                    };
                    return stepMap[status] || 0;
                },

                canContinue(workflow) {
                    return !['COMPLETED', 'FAILED', 'CANCELLED'].includes(workflow.status);
                },

                canCancel(workflow) {
                    return !['COMPLETED', 'FAILED', 'CANCELLED'].includes(workflow.status);
                },

                formatDate(dateStr) {
                    if (!dateStr) return '-';
                    const date = new Date(dateStr);
                    return date.toLocaleString('zh-CN');
                }
            }
        });
    </script>
</body>
</html>